이제 연결해서 생각해봅니다.                                                                                         
                                                                                                                      
  saju_base_prompt.dart 분석:                                                                                         
                                                                                                                      
  1. JSON 출력 요구사항이 매우 방대함:                                                                                
  - summary: 30문장                                                                                                   
  - wonGuk_analysis.reading: 최소 15문장                                                                              
  - sipsung_analysis.reading: 최소 15문장                                                                             
  - hapchung_analysis.reading: 최소 15문장                                                                            
  - personality.reading: 최소 20문장                                                                                  
  - wealth.reading: 최소 20문장                                                                                       
  - love.reading: 최소 20문장                                                                                         
  - marriage.reading: 최소 20문장                                                                                     
  - career.reading: 최소 20문장                                                                                       
  - business.reading: 최소 20문장                                                                                     
  - health.reading: 최소 15문장                                                                                       
  - sinsal_gilseong.reading: 최소 15문장                                                                              
  - life_cycles: 청년기/중년기/후년기 각 10문장                                                                       
  - peak_years.why: 최소 15문장                                                                                       
  - daeun_detail.cycles[].reading: 각 대운마다 최소 10문장                                                            
                                                                                                                      
  총합: 약 250-300문장 이상 요구! → GPT-5.2가 6분+ 걸리는 원인                                                        
                                                                                                                      
  onboarding_screen.dart 분석:                                                                                        
                                                                                                                      
  Future<void> _onSave() async {                                                                                      
    try {                                                                                                             
      await formNotifier.saveProfile(editingId: _editingProfileId);                                                   
      if (mounted) {                                                                                                  
        context.go(Routes.menu);  // ← 즉시 이동! 분석 기다리지 않음                                                  
      }                                                                                                               
    }                                                                                                                 
  }                                                                                                                   
                                                                                                                      
  ---                                                                                                                 
  문제의 연결고리                                                                                                     
                                                                                                                      
  ┌──────────────────────────────────────────────────────────────────┐                                                
  │                      문제 발생 흐름                               │                                               
  ├──────────────────────────────────────────────────────────────────┤                                                
  │                                                                  │                                                
  │  1. 온보딩에서 프로필 저장                                         │                                              
  │     └─ saveProfile() 완료 (Hive/Supabase 저장만)                  │                                               
  │                                                                  │                                                
  │  2. 즉시 menu 화면으로 이동 ← 문제!                                │                                              
  │     └─ AI 분석은 백그라운드에서 fire-and-forget으로 시작            │                                             
  │                                                                  │                                                
  │  3. Fortune 분석 (gpt-5-mini × 3)                                │                                                
  │     └─ 약 3분 소요                                                │                                               
  │                                                                  │                                                
  │  4. GPT-5.2 시작 (Fortune 완료 후!)                               │                                               
  │     └─ 프롬프트가 너무 복잡 → 6분+ 소요 ← 문제!                    │                                              
  │                                                                  │                                                
  │  5. 사용자가 이미 다른 화면/앱 종료                                 │                                             
  │     └─ 폴링 중단 → saju_base 미저장!                              │                                               
  │                                                                  │                                                
  └──────────────────────────────────────────────────────────────────┘                                                
                                                                                                                      
  ---                                                                                                                 
  수정 필요 사항                                                                                                      
                                                                                                                      
  1. prompts/saju_base_prompt.dart - 프롬프트 간소화                                                                  
                                                                                                                      
  현재: 모든 섹션에 "최소 15-20문장" 요구 → 6분+ 소요                                                                 
                                                                                                                      
  개선안:                                                                                                             
  - 필수 섹션만 남기고 나머지는 별도 분석으로 분리                                                                    
  - "최소 X문장" 요구 삭제 또는 대폭 축소                                                                             
  - 핵심 정보만 빠르게 생성 (2분 이내 목표)                                                                           
                                                                                                                      
  2. onboarding/onboarding_screen.dart - 분석 완료 대기                                                               
                                                                                                                      
  현재: 프로필 저장 후 즉시 menu로 이동                                                                               
                                                                                                                      
  개선안 A: 분석 완료까지 로딩 화면 표시                                                                              
  Future<void> _onSave() async {                                                                                      
    // 로딩 표시                                                                                                      
    showLoadingDialog("사주 분석 중...");                                                                             
                                                                                                                      
    await formNotifier.saveProfile(...);                                                                              
                                                                                                                      
    // 분석 완료 대기 (또는 최소 폴링 시작 후 이동)                                                                   
    await _waitForAnalysisOrTimeout();                                                                                
                                                                                                                      
    context.go(Routes.menu);                                                                                          
  }                                                                                                                   
                                                                                                                      
  개선안 B: 백그라운드 완료 후 알림                                                                                   
  - 즉시 이동하되, 분석 완료 시 푸시/앱 내 알림                                                                       
                                                                                                                      
  어떤 방향으로 수정할까요?                   