# ìš´ì„¸ í”„ë¡¬í”„íŠ¸ ì„¤ê³„ ë¬¸ì„œ v1.0

> **ì‘ì„±ì¼**: 2026-01-18
> **ë‹´ë‹¹**: JH_AI
> **ìƒíƒœ**: ì„¤ê³„ ì™„ë£Œ, êµ¬í˜„ ëŒ€ê¸°

---

## 1. ê°œìš”

### 1.1 ëª©í‘œ
saju_base(í‰ìƒìš´ì„¸)ë¥¼ **ê¸°ë°˜ ë°ì´í„°**ë¡œ í™œìš©í•˜ì—¬ 3ê°€ì§€ ìƒˆ ìš´ì„¸ ë¶„ì„ ì¶”ê°€:

| # | í”„ë¡¬í”„íŠ¸ | summary_type | ìš©ë„ |
|---|---------|--------------|------|
| 1 | **2026 ì‹ ë…„ìš´ì„¸** | `yearly_fortune_2026` | 2026ë…„ ì „ì²´ ìš´ì„¸ |
| 2 | **ì´ë²ˆë‹¬ ìš´ì„¸** | `monthly_fortune` | í˜„ì¬ ì›” ìš´ì„¸ |
| 3 | **ë‹¤ì‹œë³´ëŠ” 2025** | `yearly_fortune_2025` | 2025ë…„ íšŒê³  ìš´ì„¸ |

### 1.2 í•µì‹¬ ì›ì¹™
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    saju_base (GPT-5.2)                      â”‚
â”‚                      í‰ìƒìš´ì„¸ (ê¸°ë°˜)                          â”‚
â”‚    ì„±ê²©, ì ì„±, ì¬ë¬¼ìš´, ê±´ê°•ìš´, ê²°í˜¼ìš´ ë“± ì¢…í•© ë¶„ì„            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ content ì°¸ì¡°
                            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚                       â”‚
    â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2026ë…„  â”‚          â”‚ ì´ë²ˆë‹¬  â”‚           â”‚ 2025ë…„  â”‚
â”‚ ì‹ ë…„ìš´ì„¸ â”‚          â”‚  ìš´ì„¸   â”‚           â”‚  íšŒê³    â”‚
â”‚ GPT-5-miniâ”‚         â”‚GPT-5-miniâ”‚          â”‚GPT-5-miniâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ëª¨ë¸ ì„ íƒ

### 2.1 GPT-5-mini ì±„íƒ ì´ìœ 

| í•­ëª© | GPT-5.2 (í˜„ì¬ saju_base) | GPT-5-mini (ìƒˆ í”„ë¡¬í”„íŠ¸) |
|------|-------------------------|-------------------------|
| **Input** | $1.75 / 1M | **$0.25 / 1M** |
| **Output** | $14.00 / 1M | **$2.00 / 1M** |
| **ì„±ëŠ¥** | 100% | 80% (ì¶©ë¶„) |
| **ì†ë„** | 100-150ì´ˆ | **5-15ì´ˆ** |
| **ìš©ë„** | ë³µì¡í•œ ì›êµ­ ë¶„ì„ | saju_base ê¸°ë°˜ ìš”ì•½/í™•ì¥ |

**ê²°ë¡ **: saju_baseê°€ ì´ë¯¸ ìƒì„¸ ë¶„ì„ì„ ì™„ë£Œí–ˆìœ¼ë¯€ë¡œ, íŒŒìƒ ìš´ì„¸ëŠ” GPT-5-minië¡œ ì¶©ë¶„.

### 2.2 ai_constants.dart ì¶”ê°€ í•­ëª©

```dart
// OpenAIModels í´ë˜ìŠ¤ì— ì¶”ê°€
static const String gpt5Mini = 'gpt-5-mini';

// OpenAIPricing í´ë˜ìŠ¤ì— ì¶”ê°€
static const double gpt5MiniInput = 0.25;
static const double gpt5MiniOutput = 2.00;
static const double gpt5MiniCached = 0.025; // 90% í• ì¸
```

---

## 3. ìƒˆ SummaryType ì •ì˜

```dart
// ai_constants.dart - SummaryType í´ë˜ìŠ¤ì— ì¶”ê°€

/// 2026ë…„ ì‹ ë…„ìš´ì„¸
/// - ì—° 1íšŒ ìƒì„± (1ì›”)
/// - saju_base ê¸°ë°˜ í™•ì¥
static const String yearlyFortune2026 = 'yearly_fortune_2026';

/// ì´ë²ˆë‹¬ ìš´ì„¸
/// - ì›” 1íšŒ ìƒì„± (ë§¤ì›” 1ì¼)
/// - saju_base + ì›”ìš´ ë¶„ì„
static const String monthlyFortune = 'monthly_fortune';

/// 2025ë…„ íšŒê³  ìš´ì„¸
/// - 1íšŒì„± (ê³¼ê±° ë¶„ì„)
/// - saju_base ê¸°ë°˜ íšŒê³ 
static const String yearlyFortune2025 = 'yearly_fortune_2025';
```

---

## 4. íŒŒì¼ êµ¬ì¡°

```
frontend/lib/AI/
â”œâ”€â”€ core/
â”‚   â””â”€â”€ ai_constants.dart          # [ìˆ˜ì •] GPT-5-mini ì¶”ê°€, SummaryType ì¶”ê°€
â”‚
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ prompt_template.dart       # [ê¸°ì¡´] ë² ì´ìŠ¤ í´ë˜ìŠ¤
â”‚   â”œâ”€â”€ saju_base_prompt.dart      # [ê¸°ì¡´] í‰ìƒìš´ì„¸ (GPT-5.2)
â”‚   â”œâ”€â”€ daily_fortune_prompt.dart  # [ê¸°ì¡´] ì¼ìš´ (Gemini)
â”‚   â”‚
â”‚   â”œâ”€â”€ yearly_fortune_2026_prompt.dart  # [ì‹ ê·œ] 2026 ì‹ ë…„ìš´ì„¸
â”‚   â”œâ”€â”€ monthly_fortune_prompt.dart      # [ì‹ ê·œ] ì´ë²ˆë‹¬ ìš´ì„¸
â”‚   â””â”€â”€ yearly_fortune_2025_prompt.dart  # [ì‹ ê·œ] 2025 íšŒê³ 
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ queries.dart               # [ìˆ˜ì •] ìºì‹œ ì¡°íšŒ ë©”ì„œë“œ ì¶”ê°€
â”‚   â””â”€â”€ mutations.dart             # [ìˆ˜ì •] ì €ì¥ ë©”ì„œë“œ ì¶”ê°€
â”‚
â””â”€â”€ services/
    â””â”€â”€ fortune_analysis_service.dart  # [ì‹ ê·œ] ìš´ì„¸ ë¶„ì„ ì „ìš© ì„œë¹„ìŠ¤
```

---

## 5. í”„ë¡¬í”„íŠ¸ ìƒì„¸ ì„¤ê³„

### 5.1 ê³µí†µ ì…ë ¥ ë°ì´í„°

ëª¨ë“  ìƒˆ í”„ë¡¬í”„íŠ¸ëŠ” saju_baseì˜ contentë¥¼ **í•„ìˆ˜ ì…ë ¥**ìœ¼ë¡œ ë°›ìŒ:

```dart
class FortuneInputData {
  // ê¸°ë³¸ í”„ë¡œí•„ ì •ë³´
  final String profileName;
  final String birthDate;
  final String gender;

  // saju_base ë¶„ì„ ê²°ê³¼ (í•µì‹¬!)
  final Map<String, dynamic> sajuBaseContent;

  // ë§Œì„¸ë ¥ ì›ë³¸ (saju_origin)
  final Map<String, dynamic> sajuOrigin;

  // ëŒ€ìƒ ê¸°ê°„ (ë…„/ì›”)
  final int targetYear;
  final int? targetMonth;  // ì›”ìš´ì¼ ë•Œë§Œ
}
```

### 5.2 í”„ë¡¬í”„íŠ¸ë³„ ìƒì„¸

---

#### ğŸ“… 5.2.1 yearly_fortune_2026_prompt.dart

| í•­ëª© | ê°’ |
|------|-----|
| **summaryType** | `yearly_fortune_2026` |
| **modelName** | `gpt-5-mini` |
| **maxTokens** | 4096 |
| **temperature** | 0.7 |
| **cacheExpiry** | 30ì¼ |

**ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ í•µì‹¬:**
```
ë‹¹ì‹ ì€ ì‚¬ì£¼ëª…ë¦¬í•™ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì‚¬ìš©ìì˜ í‰ìƒ ì‚¬ì£¼ ë¶„ì„(saju_base)ì„ ê¸°ë°˜ìœ¼ë¡œ 2026ë…„ ìš´ì„¸ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.

## ë¶„ì„ ê¸°ì¤€
1. saju_baseì˜ ì„±ê²©/ì ì„±/ì¬ë¬¼ìš´ ë“±ì„ 2026ë…„ ìš´ê¸°ì™€ ì—°ê²°
2. 2026ë…„ ë³‘ì˜¤(ä¸™åˆ)ë…„ ì²œê°„ì§€ì§€ ì˜í–¥ ë¶„ì„
3. ìš©ì‹ /ê¸°ì‹ ê³¼ ì„¸ìš´ì˜ ê´€ê³„
4. ë¶„ê¸°ë³„ ìš´ê¸° ë³€í™”

## ì‘ë‹µ í˜•ì‹
JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜
```

**ì‘ë‹µ JSON ìŠ¤í‚¤ë§ˆ:**
```json
{
  "year": 2026,
  "yearGanji": "ë³‘ì˜¤(ä¸™åˆ)",
  "overallScore": 75,
  "summary": "2026ë…„ ì „ì²´ ìš´ì„¸ ìš”ì•½ (2-3ë¬¸ì¥)",

  "quarterly": {
    "q1": {
      "months": "1-3ì›”",
      "score": 70,
      "theme": "ìƒˆë¡œìš´ ì‹œì‘",
      "advice": "1ë¶„ê¸° ì¡°ì–¸"
    },
    "q2": { ... },
    "q3": { ... },
    "q4": { ... }
  },

  "categories": {
    "career": { "score": 80, "analysis": "..." },
    "wealth": { "score": 70, "analysis": "..." },
    "love": { "score": 75, "analysis": "..." },
    "health": { "score": 85, "analysis": "..." }
  },

  "luckyElements": {
    "color": "ë¹¨ê°•",
    "number": 7,
    "direction": "ë‚¨ìª½"
  },

  "monthlyHighlights": {
    "best": { "month": 6, "reason": "..." },
    "caution": { "month": 10, "reason": "..." }
  },

  "yearAdvice": "2026ë…„ í•µì‹¬ ì¡°ì–¸ (3-4ë¬¸ì¥)"
}
```

---

#### ğŸ“† 5.2.2 monthly_fortune_prompt.dart

| í•­ëª© | ê°’ |
|------|-----|
| **summaryType** | `monthly_fortune` |
| **modelName** | `gpt-5-mini` |
| **maxTokens** | 2048 |
| **temperature** | 0.7 |
| **cacheExpiry** | 7ì¼ |

**ìƒì„±ì:**
```dart
MonthlyFortunePrompt({
  required this.targetYear,
  required this.targetMonth,
});
```

**ì‘ë‹µ JSON ìŠ¤í‚¤ë§ˆ:**
```json
{
  "year": 2026,
  "month": 1,
  "monthGanji": "ê²½ì¸(åºšå¯…)",
  "overallScore": 72,
  "summary": "ì´ë²ˆë‹¬ ìš´ì„¸ ìš”ì•½",

  "weekly": {
    "week1": { "score": 70, "focus": "..." },
    "week2": { "score": 75, "focus": "..." },
    "week3": { "score": 68, "focus": "..." },
    "week4": { "score": 80, "focus": "..." }
  },

  "categories": {
    "career": { "score": 75, "tip": "..." },
    "wealth": { "score": 70, "tip": "..." },
    "love": { "score": 72, "tip": "..." },
    "health": { "score": 80, "tip": "..." }
  },

  "luckyDays": [3, 12, 21],
  "cautionDays": [7, 16],

  "monthAdvice": "ì´ë²ˆë‹¬ í•µì‹¬ ì¡°ì–¸"
}
```

---

#### ğŸ”™ 5.2.3 yearly_fortune_2025_prompt.dart

| í•­ëª© | ê°’ |
|------|-----|
| **summaryType** | `yearly_fortune_2025` |
| **modelName** | `gpt-5-mini` |
| **maxTokens** | 3072 |
| **temperature** | 0.7 |
| **cacheExpiry** | ë¬´ê¸°í•œ (ê³¼ê±°ëŠ” ë³€í•˜ì§€ ì•ŠìŒ) |

**íŠ¹ì§•:**
- ê³¼ê±° ë¶„ì„ì´ë¯€ë¡œ **íšŒê³ /ë³µê¸°** ê´€ì 
- "ì´ëŸ° ì¼ì´ ìˆì—ˆì„ ìˆ˜ ìˆë‹¤" â†’ "ì´ë ‡ê²Œ í™œìš©í•˜ì„¸ìš”"

**ì‘ë‹µ JSON ìŠ¤í‚¤ë§ˆ:**
```json
{
  "year": 2025,
  "yearGanji": "ì„ì‚¬(ä¹™å·³)",
  "overallScore": 68,
  "summary": "2025ë…„ íšŒê³  ìš”ì•½",

  "retrospective": {
    "achievements": ["ì„±ì·¨ ê°€ëŠ¥í–ˆë˜ ê²ƒë“¤"],
    "challenges": ["ì–´ë ¤ì› ë˜ ì ë“¤"],
    "lessons": ["ë°°ìš¸ ìˆ˜ ìˆëŠ” êµí›ˆ"]
  },

  "quarterlyReview": {
    "q1": { "theme": "...", "insight": "..." },
    "q2": { ... },
    "q3": { ... },
    "q4": { ... }
  },

  "carryForward": {
    "strengths": "2026ë…„ì— ê°€ì ¸ê°ˆ ê°•ì ",
    "improvements": "ê°œì„ í•  ì ",
    "advice": "ì•ìœ¼ë¡œì˜ ì¡°ì–¸"
  }
}
```

---

## 6. ë°ì´í„° íë¦„

### 6.1 íŠ¸ë¦¬ê±° ì‹œì 

| í”„ë¡¬í”„íŠ¸ | íŠ¸ë¦¬ê±° ì‹œì  | ì¡°ê±´ |
|---------|-----------|------|
| yearly_fortune_2026 | í™ˆ í™”ë©´ ì§„ì… | saju_base ì¡´ì¬ & 2026 ìš´ì„¸ ë¯¸ì¡´ì¬ |
| monthly_fortune | í™ˆ í™”ë©´ ì§„ì… | saju_base ì¡´ì¬ & ì´ë²ˆë‹¬ ìš´ì„¸ ë¯¸ì¡´ì¬ |
| yearly_fortune_2025 | ì‚¬ìš©ì ìš”ì²­ | saju_base ì¡´ì¬ |

### 6.2 ì„œë¹„ìŠ¤ í”Œë¡œìš°

```
[UI: í™ˆ í™”ë©´]
      â”‚
      â–¼
[fortune_analysis_service.dart]
      â”‚
      â”œâ”€â”€ 1. saju_base ìºì‹œ ì¡°íšŒ (í•„ìˆ˜)
      â”‚       â””â”€â”€ ì—†ìœ¼ë©´ ì—ëŸ¬ ë°˜í™˜
      â”‚
      â”œâ”€â”€ 2. ëŒ€ìƒ ìš´ì„¸ ìºì‹œ ì¡°íšŒ
      â”‚       â””â”€â”€ ìˆìœ¼ë©´ ìºì‹œ ë°˜í™˜
      â”‚
      â”œâ”€â”€ 3. FortuneInputData êµ¬ì„±
      â”‚       â”œâ”€â”€ profileData
      â”‚       â”œâ”€â”€ sajuBaseContent  â† saju_base.content
      â”‚       â””â”€â”€ sajuOrigin       â† saju_base.content.saju_origin
      â”‚
      â”œâ”€â”€ 4. í”„ë¡¬í”„íŠ¸ ìƒì„± & API í˜¸ì¶œ
      â”‚       â””â”€â”€ GPT-5-mini
      â”‚
      â””â”€â”€ 5. ê²°ê³¼ ì €ì¥
              â””â”€â”€ ai_summaries í…Œì´ë¸”
```

---

## 7. êµ¬í˜„ ìˆœì„œ (ì²´í¬ë¦¬ìŠ¤íŠ¸)

### Phase 1: ì¸í”„ë¼ (ai_constants.dart)
- [ ] GPT-5-mini ëª¨ë¸ ìƒìˆ˜ ì¶”ê°€ (`OpenAIModels.gpt5Mini`)
- [ ] GPT-5-mini ê°€ê²© ì¶”ê°€ (`OpenAIPricing`)
- [ ] SummaryType 3ê°œ ì¶”ê°€
- [ ] CacheExpiry 2ê°œ ì¶”ê°€

### Phase 2: í”„ë¡¬í”„íŠ¸ íŒŒì¼ ìƒì„±
- [ ] yearly_fortune_2026_prompt.dart
- [ ] monthly_fortune_prompt.dart
- [ ] yearly_fortune_2025_prompt.dart

### Phase 3: ë°ì´í„° ë ˆì´ì–´
- [ ] queries.dart - ìºì‹œ ì¡°íšŒ ë©”ì„œë“œ ì¶”ê°€
  - `getYearlyFortune2026(profileId)`
  - `getMonthlyFortune(profileId, year, month)`
  - `getYearlyFortune2025(profileId)`
- [ ] mutations.dart - ì €ì¥ ë©”ì„œë“œ ì¶”ê°€
  - `saveYearlyFortune2026(...)`
  - `saveMonthlyFortune(...)`
  - `saveYearlyFortune2025(...)`

### Phase 4: ì„œë¹„ìŠ¤ ë ˆì´ì–´
- [ ] fortune_analysis_service.dart ìƒì„±
  - `analyzeYearlyFortune2026()`
  - `analyzeMonthlyFortune()`
  - `analyzeYearlyFortune2025()`

### Phase 5: Supabase
- [ ] ai_summaries.summary_type CHECK ì œì•½ ìˆ˜ì •
  - ì¶”ê°€: 'yearly_fortune_2026', 'monthly_fortune', 'yearly_fortune_2025'

### Phase 6: UI ì—°ë™
- [ ] í™ˆ í™”ë©´ì—ì„œ íŠ¸ë¦¬ê±°
- [ ] ê²°ê³¼ í‘œì‹œ UI

---

## 8. ì˜ˆìƒ ë¹„ìš©

### 8.1 í† í° ì¶”ì • (í”„ë¡¬í”„íŠ¸ë‹¹)

| í”„ë¡¬í”„íŠ¸ | Input | Output | í•©ê³„ |
|---------|-------|--------|------|
| yearly_fortune_2026 | ~3000 | ~2000 | 5000 |
| monthly_fortune | ~2000 | ~1000 | 3000 |
| yearly_fortune_2025 | ~2500 | ~1500 | 4000 |

### 8.2 ë¹„ìš© ê³„ì‚° (GPT-5-mini ê¸°ì¤€)

| í”„ë¡¬í”„íŠ¸ | Input ë¹„ìš© | Output ë¹„ìš© | **ì´ ë¹„ìš©** |
|---------|-----------|------------|------------|
| yearly_fortune_2026 | $0.00075 | $0.004 | **$0.00475** |
| monthly_fortune | $0.0005 | $0.002 | **$0.0025** |
| yearly_fortune_2025 | $0.000625 | $0.003 | **$0.003625** |

**ì‚¬ìš©ìë‹¹ ì—°ê°„ ì˜ˆìƒ ë¹„ìš©**: ~$0.05 (ë§¤ìš° ì €ë ´)

---

## 9. ì°¸ê³  íŒŒì¼

| íŒŒì¼ | ìš©ë„ |
|------|------|
| `_TEMPLATE.dart` | í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ |
| `saju_base_prompt.dart` | í‰ìƒìš´ì„¸ (ì°¸ê³ ìš©) |
| `daily_fortune_prompt.dart` | ì¼ìš´ (ì°¸ê³ ìš©) |
| `ai_constants.dart` | ìƒìˆ˜ ì •ì˜ |
| `queries.dart` | ìºì‹œ ì¡°íšŒ íŒ¨í„´ |
| `mutations.dart` | ì €ì¥ íŒ¨í„´ |
| `saju_analysis_service.dart` | ì„œë¹„ìŠ¤ íŒ¨í„´ |

---

## 10. ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë²„ì „ | ë³€ê²½ ë‚´ìš© |
|------|------|---------|
| 2026-01-18 | v1.0 | ì´ˆì•ˆ ì‘ì„± |
